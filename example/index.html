<!DOCTYPE html>
<!--[if lt IE 7]><html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]-->
<!--[if IE 7]><html lang="en" class="no-js lt-ie9 lt-ie8"><![endif]-->
<!--[if IE 8]><html lang="en" class="no-js lt-ie9"><![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en" class="no-js"><!--<![endif]-->
  <head>
    <title>Stormpath Widget Demo</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://unpkg.com/purecss@0.6.2/build/pure-min.css" integrity="sha384-UQiGfs9ICog+LwheBSRCt1o5cbyKIHbwjWscjemyBMT9YCUMZffs6UqUTd0hObXD" crossorigin="anonymous">
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="https://unpkg.com/purecss@0.6.2/build/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="https://unpkg.com/purecss@0.6.2/build/grids-responsive-min.css">
    <!--<![endif]-->
    <link rel="stylesheet" href="example.css">

    <!-- Include a reference to the Stormpath Widget -->
    <script src="/js/app.js"></script>

    <!-- Include code to activate the widget when you click specific buttons -->
    <script>
      console.log('Loaded Stormpath v%s.', Stormpath.version);

      function initializeView(stormpath) {
        // Authenticated
        var authenticatedContainer = document.getElementById('authenticated');
        var loginButton = document.getElementById('login-button');
        var signupButton = document.getElementById('signup-button');

        authenticatedContainer.style.display = 'none';
        loginButton.addEventListener('click', function() { stormpath.showLogin(); });
        signupButton.addEventListener('click', function() { stormpath.showRegistration(); });

        // Unauthenticated
        var unauthenticatedContainer = document.getElementById('unauthenticated');
        var logoutButton = document.getElementById('logout-button');

        unauthenticatedContainer.style.display = 'none';
        logoutButton.addEventListener('click', function() { stormpath.logout(); });

        if ((/#verify/).test(window.location.href)) {
          stormpath.showEmailVerification();
        }
      }

      function onDocumentReady() {
        var stormpath = new Stormpath({
          appUri: 'YOUR_CLIENT_API_DOMAIN'
        });

        if ((/#change-password/).test(window.location.href)) {
          stormpath.showChangePassword();
        }

        stormpath.on('authenticated', function() {
          console.log('We\'re authenticated!');

          stormpath.remove();

          document.getElementById('authenticated').style.display = 'block';
          document.getElementById('unauthenticated').style.display = 'none';

          stormpath.getAccount().then(function (account) {
            document.getElementById('account-full-name').innerHTML = account.givenName;
          });

          stormpath.getAccessToken().then(function (accessToken) {
            if (!accessToken) {
              accessToken = "(none, in cookie mode)";
            }

            document.getElementById('access-token').innerHTML = accessToken;
          });
        });

        stormpath.on('unauthenticated', function() {
          console.log('We\'re not authenticated. Showing login/registration options.');

          document.getElementById('authenticated').style.display = 'none';
          document.getElementById('unauthenticated').style.display = 'block';
        });

        stormpath.on('forgotPasswordSent', function (data) {
          console.log('User just requested to reset his password!', data);
        });

        stormpath.on('changedPassword', function() {
          console.log('User just changed his password!');
        });

        stormpath.once('registered', function (account) {
          console.log('User just created a new account!', account);
        });

        stormpath.once('loggedIn', function (account) {
          console.log('User just logged in!', account);
        });

        stormpath.once('loggedOut', function () {
          console.log('User just logged out!');
        });

        stormpath.on('loginError', function (error) {
          console.error(error);
        });

        initializeView(stormpath);
      }

      window.onload = onDocumentReady;
    </script>
  </head>

  <body>
    <div class="header">
        <div class="home-menu pure-menu pure-menu-horizontal pure-menu-fixed">
            <a class="pure-menu-heading" href="">Demo</a>
        </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <h1 class="splash-head">Stormpath Widget</h1>

        <!-- This div will be shown when the user is logged in.
              The widget's 'authenticated'' event will show or hide it. -->
        <div id="authenticated">
          <p class="splash-subhead">
            Hi <span id="account-full-name"></span>, you are logged in!
          </p>

          <p>
            This is your access token: <span id="access-token"></span>
          </p>
          
          <p>
            <a id="logout-button" class="pure-button pure-button-primary">Log out</a>
          </p>
        </div>

        <!-- This div will be shown when the user is NOT logged in. -->
        <div id="unauthenticated">
          <p class="splash-subhead">
            Click one of these handy buttons:
          </p>
          <p>
            <a id="login-button" class="pure-button pure-button-primary">Log in</a>
            <a id="signup-button" class="pure-button pure-button-primary">Sign up</a>
          </p>
        </div>
      </div>
    </div>

    <div class="footer">
        View the source of this page to learn how it's done! Layout by <a href="https://purecss.io">Pure CSS</a>.
    </div>

  </body>
</html>
